const e=new WeakMap,t=new WeakMap;function n(n,o,s,r){let c=e.get(n);c||(c=new Map,e.set(n,c));let i=c.get(o);i||(i=new Set,c.set(o,i)),i.add(s),t.set(s,r)}function o(n){const o={},s=e.get(n);if(s)for(const[e,n]of s){o[e]=[];for(const s of n){const n=t.get(s);o[e].push({listener:s,options:n})}}return o}const s="#text",r="#comment",c="#document-fragment";function i(e,t={},n=[]){return e=e.toLocaleLowerCase(),t=Object.assign({},t),n=[...n],t.textContent||s!==e&&r!==e||(t.textContent=""),{type:e,properties:t,children:n}}function f(t,o={}){"boolean"==typeof o&&(o={deep:o,event:o});const{deep:s=!1,event:r=!1}=o,c=i(t.type,Object.assign({},t.properties),s?t.children.map(e=>f(e,o)):[]);return r&&function(t,o){const s=e.get(o);if(s)for(const[e,o]of s)for(const s of o)n(t,e,s)}(c,t),c}function p(e,t,o,c){const p="string"==typeof e?i(e):e instanceof Node?function e(t,n=!1){const o=t.nodeName,s={};if(t instanceof Element)for(const{name:e,value:n}of t.attributes)s[e]=n;else(t instanceof Comment||t instanceof Text)&&(s.textContent=t.textContent||"");return i(o,s,n?[...t.childNodes].map(t=>e(t,n)):[])}(e,!0):f(e,{deep:!0});if("object"!=typeof t||Array.isArray(t))void 0!==t&&(o=t);else{const{events:e,properties:o}=function(e){const t={events:{},properties:{}};for(const n of Object.keys(e)){const o=e[n];"string"==typeof o?t.properties[n]=o:o&&(t.events[n]=o)}return t}(t);p.properties=Object.assign(Object.assign({},p.properties),o);for(const t of Object.keys(e)){const o=e[t];"function"==typeof o?n(p,t,o):n(p,t,o.listener,o.options)}}if("string"==typeof o){[s,r].includes(p.type)?p.properties.textContent=o:p.children=[i("#text",{textContent:o})]}else Array.isArray(o)?p.children=o.map(e=>"string"==typeof e?i("#text",{textContent:e}):e):void 0!==o&&(c=o);return c&&(p.children=p.children.filter(e=>{if(e.type===r)return!1;if(e.type===s){if(void 0===e.properties.textContent)return!1;if(!/^\s*$/.test(e.properties.textContent))return!1}return!0})),p}function a(e){switch(e.type){case s:return document.createTextNode(e.properties.textContent||"");case r:return document.createComment(e.properties.textContent||"");default:return document.createElement(e.type)}}function l(e,t){const n={};if(e!==t)if(e){const o=Object.keys(e);if(t){const s=Object.keys(t),r=new Set([...o,...s]);for(const o of r){const s=e[o],r=t[o];s!==r&&(n[o]=[s,r])}}else for(const t of o){const o=e[t];n[t]=[o,void 0]}}else if(t){const e=Object.keys(t);for(const o of e){const e=t[o];n[o]=[void 0,e]}}return n}const u=new WeakMap,d=new WeakMap;function y(e,...t){if(t.length<1)return;!function e(t,n){const s=u.get(t)||[...t.childNodes].map(e=>p(e));u.set(t,n);let r=0,c=0,i=0;const f=n.length,y=s.length,m=Math.max(f,y);for(;r<m;){const p=n[c],m=s[i],h=m&&d.get(m);if(p){let n=h;if(!m||m.type!==p.type){const e=a(p);n=e,h?(u.delete(h),f>y?(t.insertBefore(e,h),i--):f<y?(t.removeChild(h),c--):t.replaceChild(e,h)):t.appendChild(e)}if(n){d.set(p,n);const t=l(p.properties,m&&m.properties);if(n instanceof Element){for(const e of Object.keys(t)){const o=t[e],s=o&&o[0];s?n.setAttribute(e,s):n.removeAttribute(e)}if(m){const e=o(m);for(const t of Object.keys(e)){const o=e[t];for(const{listener:e}of o)n.removeEventListener(t,e)}}const e=o(p);for(const t of Object.keys(e)){const o=e[t];for(const{listener:e,options:s}of o)n.addEventListener(t,e,s)}}else t.textContent&&(n.textContent=t.textContent[0]||"");e(n,p.children)}}else if(h){const e=h.parentElement;e&&e.removeChild(h)}r++,c++,i++}}(e,function e(t){const n=[];for(const o of t)if(o.type===c){const t=e(o.children);n.push(...t)}else n.push(o);return n}(t).map(e=>f(e,!0)))}export{f as cloneNode,p as createNode,y as render};
//# sourceMappingURL=index.min.js.map
