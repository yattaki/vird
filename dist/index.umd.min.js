!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).vird={})}(this,(function(e){"use strict";const t=new WeakMap,n=new WeakMap;function o(e,o,s,r){let c=t.get(e);c||(c=new Map,t.set(e,c));let i=c.get(o);i||(i=new Set,c.set(o,i)),i.add(s),n.set(s,r)}function s(e,o){const s=t.get(o);if(s)for(const[t,o]of s)for(const s of o)e.addEventListener(t,s,n.get(s))}function r(e,n){const o=t.get(n);if(o)for(const[t,n]of o)for(const o of n)e.removeEventListener(t,o)}const c="#text",i="#comment",f="#document-fragment";function p(e,t={},n=[]){return e=e.toLocaleLowerCase(),t=Object.assign({},t),n=[...n],t.textContent||c!==e&&i!==e||(t.textContent=""),{type:e,properties:t,children:n}}function a(e,n={}){"boolean"==typeof n&&(n={deep:n,event:n});const{deep:s=!1,event:r=!1}=n,c=p(e.type,Object.assign({},e.properties),s?e.children.map(e=>a(e,n)):[]);return r&&function(e,n){const s=t.get(n);if(s)for(const[t,n]of s)for(const s of n)o(e,t,s)}(c,e),c}function l(e,t,n,s){const r="string"==typeof e?p(e):e instanceof Node?function e(t,n=!1){const o=t.nodeName,s={};if(t instanceof Element){for(const{name:e,value:n}of t.attributes)s[e]=n;"value"in t&&(s.value=t.value)}else(t instanceof Comment||t instanceof Text)&&(s.textContent=t.textContent||"");return p(o,s,n?[...t.childNodes].map(t=>e(t,n)):[])}(e,!0):a(e,{deep:!0});if("object"!=typeof t||Array.isArray(t))void 0!==t&&(n=t);else{const{events:e,properties:n}=function(e){const t={events:{},properties:{}};for(const n of Object.keys(e)){const o=e[n];"string"==typeof o?t.properties[n]=o:o&&(t.events[n]=o)}return t}(t);r.properties=Object.assign(Object.assign({},r.properties),n);for(const t of Object.keys(e)){const n=e[t];"function"==typeof n?o(r,t,n):o(r,t,n.listener,n.options)}}if("string"==typeof n){[c,i].includes(r.type)?r.properties.textContent=n:r.children=[p("#text",{textContent:n})]}else Array.isArray(n)?r.children=n.map(e=>"string"==typeof e?p("#text",{textContent:e}):e):void 0!==n&&(s=n);return s&&(r.children=r.children.filter(e=>{if(e.type===i)return!1;if(e.type===c){if(void 0===e.properties.textContent)return!1;if(!/^\s*$/.test(e.properties.textContent))return!1}return!0})),r}const d=[];function u(e,t,n){if(null!=n){const o=Array.isArray(n)?n.join(" "):String(n);switch(t){case"value":e.value=o;break;default:e.setAttribute(t,o)}}else e.removeAttribute(t)}const m=new WeakMap,y=new WeakMap;function h(e){let t;switch(e.type){case c:t=document.createTextNode(e.properties.textContent||"");break;case i:t=document.createComment(e.properties.textContent||"");break;default:t=function(e){const t=document.createElement(e.type);for(const n of Object.keys(e.properties))u(t,n,e.properties[n]);s(t,e);const n=e.children.map(e=>a(e,!0)),o=document.createDocumentFragment();for(const e of n){const t=h(e);o.appendChild(t)}const r=requestAnimationFrame(()=>{t.appendChild(o),m.set(t,n)});return d.push(r),t}(e)}return y.set(e,t),t}function v(e,t){const n={};if(e!==t)if(e){const o=Object.keys(e);if(t){const s=Object.keys(t),r=new Set([...o,...s]);for(const o of r){const s=e[o],r=t[o];s!==r&&(n[o]=[s,r])}}else for(const t of o){const o=e[t];n[t]=[o,void 0]}}else if(t){const e=Object.keys(t);for(const o of e){const e=t[o];n[o]=[void 0,e]}}return n}function g(e){m.delete(e);for(const t of e.childNodes)g(t)}e.cloneNode=a,e.createNode=l,e.render=function(e,...n){for(const e of d)cancelAnimationFrame(e);if(d.length=0,n.length<1)return;!function e(n,o){const c=m.get(n)||[...n.childNodes].map(e=>l(e));let i=0,f=0,p=0;const a=o.length,d=c.length,x=Math.max(a,d);for(;i<x;){const l=o[f],m=c[p],x=m&&y.get(m);if(l)if(m&&m.type===l.type){if(x){y.delete(m),y.set(l,x);const n=v(l.properties,m.properties);if(x instanceof Element){for(const e of Object.keys(n)){const t=n[e];u(x,e,t&&t[0])}m&&(r(x,m),C=m,t.delete(C)),s(x,l)}else n.textContent&&(x.textContent=n.textContent[0]||"");e(x,l.children)}}else{const e=h(l);if(x){g(x);const t=x.parentElement;t===n&&(a>d?(t.insertBefore(e,x),p--):a<d?(t.removeChild(x),f--):t.replaceChild(e,x))}else n.appendChild(e)}else if(x){const e=x.parentElement;e&&e.removeChild(x)}i++,f++,p++}var C;m.set(n,o)}(e,function e(t){const n=[];for(const o of t)if(o.type===f){const t=e(o.children);n.push(...t)}else n.push(o);return n}(n.map(e=>a(e,!0))))},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
