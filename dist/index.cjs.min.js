"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=new WeakMap,t=new WeakMap;function n(n,o,s,r){let c=e.get(n);c||(c=new Map,e.set(n,c));let i=c.get(o);i||(i=new Set,c.set(o,i)),i.add(s),t.set(s,r)}function o(n,o){const s=e.get(o);if(s)for(const[e,o]of s)for(const s of o)n.addEventListener(e,s,t.get(s))}function s(t,n){const o=e.get(n);if(o)for(const[e,n]of o)for(const o of n)t.removeEventListener(e,o)}const r="#text",c="#comment",i="#document-fragment";function f(e,t={},n=[]){return e=e.toLocaleLowerCase(),t=Object.assign({},t),n=[...n],t.textContent||r!==e&&c!==e||(t.textContent=""),{type:e,properties:t,children:n}}function p(t,o={}){"boolean"==typeof o&&(o={deep:o,event:o});const{deep:s=!1,event:r=!1}=o,c=f(t.type,Object.assign({},t.properties),s?t.children.map(e=>p(e,o)):[]);return r&&function(t,o){const s=e.get(o);if(s)for(const[e,o]of s)for(const s of o)n(t,e,s)}(c,t),c}function a(e,t,o,s){const i="string"==typeof e?f(e):e instanceof Node?function e(t,n=!1){const o=t.nodeName,s={};if(t instanceof Element){for(const{name:e,value:n}of t.attributes)s[e]=n;"value"in t&&(s.value=t.value)}else(t instanceof Comment||t instanceof Text)&&(s.textContent=t.textContent||"");return f(o,s,n?[...t.childNodes].map(t=>e(t,n)):[])}(e,!0):p(e,{deep:!0});if("object"!=typeof t||Array.isArray(t))void 0!==t&&(o=t);else{const{events:e,properties:o}=function(e){const t={events:{},properties:{}};for(const n of Object.keys(e)){const o=e[n];"string"==typeof o?t.properties[n]=o:o&&(t.events[n]=o)}return t}(t);i.properties=Object.assign(Object.assign({},i.properties),o);for(const t of Object.keys(e)){const o=e[t];"function"==typeof o?n(i,t,o):n(i,t,o.listener,o.options)}}if("string"==typeof o){[r,c].includes(i.type)?i.properties.textContent=o:i.children=[f("#text",{textContent:o})]}else Array.isArray(o)?i.children=o.map(e=>"string"==typeof e?f("#text",{textContent:e}):e):void 0!==o&&(s=o);return s&&(i.children=i.children.filter(e=>{if(e.type===c)return!1;if(e.type===r){if(void 0===e.properties.textContent)return!1;if(!/^\s*$/.test(e.properties.textContent))return!1}return!0})),i}const l=[];function u(e,t,n){if(null!=n){const o=Array.isArray(n)?n.join(" "):String(n);switch(t){case"value":e.value=o;break;default:e.setAttribute(t,o)}}else e.removeAttribute(t)}const d=new WeakMap,m=new WeakMap;function y(e){let t;switch(e.type){case r:t=document.createTextNode(e.properties.textContent||"");break;case c:t=document.createComment(e.properties.textContent||"");break;default:t=function(e){const t=document.createElement(e.type);for(const n of Object.keys(e.properties))u(t,n,e.properties[n]);o(t,e);const n=e.children.map(e=>p(e,!0)),s=document.createDocumentFragment();for(const e of n){const t=y(e);s.appendChild(t)}const r=requestAnimationFrame(()=>{t.appendChild(s),d.set(t,n)});return l.push(r),t}(e)}return m.set(e,t),t}function h(e,t){const n={};if(e!==t)if(e){const o=Object.keys(e);if(t){const s=Object.keys(t),r=new Set([...o,...s]);for(const o of r){const s=e[o],r=t[o];s!==r&&(n[o]=[s,r])}}else for(const t of o){const o=e[t];n[t]=[o,void 0]}}else if(t){const e=Object.keys(t);for(const o of e){const e=t[o];n[o]=[void 0,e]}}return n}function v(e){d.delete(e);for(const t of e.childNodes)v(t)}exports.cloneNode=p,exports.createNode=a,exports.render=function(t,...n){for(const e of l)cancelAnimationFrame(e);if(l.length=0,n.length<1)return;!function t(n,r){const c=d.get(n)||[...n.childNodes].map(e=>a(e));let i=0,f=0,p=0;const l=r.length,x=c.length,g=Math.max(l,x);for(;i<g;){const a=r[f],d=c[p],g=d&&m.get(d);if(a)if(d&&d.type===a.type){if(g){m.delete(d),m.set(a,g);const n=h(a.properties,d.properties);if(g instanceof Element){for(const e of Object.keys(n)){const t=n[e];u(g,e,t&&t[0])}d&&(s(g,d),C=d,e.delete(C)),o(g,a)}else n.textContent&&(g.textContent=n.textContent[0]||"");t(g,a.children)}}else{const e=y(a);if(g){v(g);const t=g.parentElement;t===n&&(l>x?(t.insertBefore(e,g),p--):l<x?(t.removeChild(g),f--):t.replaceChild(e,g))}else n.appendChild(e)}else if(g){const e=g.parentElement;e&&e.removeChild(g)}i++,f++,p++}var C;d.set(n,r)}(t,function e(t){const n=[];for(const o of t)if(o.type===i){const t=e(o.children);n.push(...t)}else n.push(o);return n}(n.map(e=>p(e,!0))))};
//# sourceMappingURL=index.cjs.min.js.map
